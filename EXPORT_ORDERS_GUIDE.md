# 订单导出功能说明

## 功能概述
订单管理页面现在支持按时间范围和订单状态筛选导出订单数据到Excel。

## 新增功能

### 1. 日期范围筛选
- **开始日期**: 选择订单创建的开始时间（包含该日期）
- **结束日期**: 选择订单创建的结束时间（包含该日期）
- 可以只选择开始日期或结束日期之一
- 留空则不限制时间范围

### 2. 订单状态筛选
在原有的发货状态、支付状态、标签筛选基础上，新增了**订单状态**筛选：
- **全部订单状态**: 不限制订单状态
- **待处理**: pending
- **生产中**: in_production
- **已发货**: shipped
- **已完成**: completed

### 3. 导出流程

1. **选择订单**: 在订单列表中勾选需要导出的订单
   - 可以使用表头的复选框全选当前页所有订单
   - 也可以单独勾选特定订单

2. **设置筛选条件**（可选）:
   - 开始日期：选择起始日期
   - 结束日期：选择结束日期
   - 订单状态：选择特定订单状态

3. **点击导出按钮**: 点击"导出Excel"按钮
   - 系统会根据筛选条件过滤已选订单
   - 如果筛选后没有符合条件的订单，会弹出提示

4. **文件下载**: 
   - 文件名格式：`订单列表_[日期范围]_[状态]_导出日期.xlsx`
   - 例如：`订单列表_2025-01-01至2025-01-31_生产中_2025-11-26.xlsx`

### 4. 导出内容
Excel文件包含以下信息：
- 交货时间
- 订单编号
- 备注
- 评论
- 高温定型费用
- 布料型号
- 布料采购米数
- 布料单价
- 布料成本
- 衬布单价
- 衬布成本
- 加工方式
- 布料高度
- 墙宽
- 每片用料
- 分片
- 倍数
- 窗户数量
- 是否定型
- 衬布
- 绑带
- 加工

## 使用场景示例

### 场景1: 导出本月所有待处理订单
1. 选择开始日期：2025-11-01
2. 选择结束日期：2025-11-30
3. 订单状态：待处理
4. 全选订单
5. 点击导出Excel

### 场景2: 导出最近一周的生产中订单
1. 选择开始日期：往前推7天
2. 不设置结束日期（默认到今天）
3. 订单状态：生产中
4. 全选订单
5. 点击导出Excel

### 场景3: 导出所有已完成订单
1. 不设置日期范围
2. 订单状态：已完成
3. 全选订单
4. 点击导出Excel

## 注意事项

1. **必须先选择订单**: 如果没有选择任何订单，导出按钮会提示"请先选择要导出的订单"

2. **筛选结果为空**: 如果设置的筛选条件过滤后没有符合的订单，会提示"根据筛选条件没有找到符合的订单"

3. **日期筛选逻辑**: 
   - 开始日期从当天的00:00:00开始
   - 结束日期到当天的23:59:59结束

4. **清除筛选**: 点击"清除"按钮可以清除所有筛选条件，包括日期和订单状态

5. **订单状态来源**: 订单状态是存储在数据库中的自定义状态，不是Shopify的原生状态

## 部署说明

此功能已完全实现在前端，无需数据库迁移。部署步骤：

```bash
cd /var/www/shopify-app
git pull
npm run build
pm2 restart shopify-app
```
